<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>XML: [xml] Win32 shared object</title>
<meta name="Author" content="Igor Zlatkovic (igorz@dialup.nacamar.de)">
<meta name="Subject" content="[xml] Win32 shared object">
<link rev="made" href="mailto:veillard@w3.org">
</head>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<h1>[xml] Win32 shared object</h1>
<!-- received="Sun Jan 21 17:58:17 2001" -->
<!-- isoreceived="20010121225817" -->
<!-- sent="Sun, 21 Jan 2001 20:34:13 +0100" -->
<!-- isosent="20010121193413" -->
<!-- name="Igor Zlatkovic" -->
<!-- email="igorz@dialup.nacamar.de" -->
<!-- subject="[xml] Win32 shared object" -->
<!-- id="000701c083e1$22d3ccc0$0b01a8c0@home.loc" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
<th><a href="author.html">Author view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Igor Zlatkovic (<a href="mailto:igorz@dialup.nacamar.de?subject=Re:%20[xml]%20Win32%20shared%20object"><em>igorz@dialup.nacamar.de</em></a>)<br>
<strong>Date:</strong> Sun Jan 21 2001 - 14:34:13 EST
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="1363.html">Daniel Veillard: "Re: [xml] xmlElemDumpMemory"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<p>
Hi there.
<br>
<p>The following applies to the upcoming release 2.2.12 under Win32, and that
<br>
only if using Microsoft Visual C++ compiler to build libxml2. It is nothing
<br>
critical, as it has nothing to do with the actual functionality of libxml2,
<br>
but only with the build process.
<br>
<p>Few days ago, I sent two MSDEV project files to Daniel Veillard. According
<br>
to Daniel, these project files shall appear in the next release, 2.2.12. One
<br>
of these project files enables compiling libxml2 as a shared object (DLL)
<br>
under Win32, using Visual C++.
<br>
<p>In the meantime, I have discovered something. Under few very common
<br>
circumstances, the linker refuses to build an import library. Further
<br>
investigation revealed that the resulting libxml2.dll, which was built,
<br>
exports no symbols. Having a DLL which exports nothing, the linker thought
<br>
it apropriate to avoid building the import library.
<br>
<p>Well, a shared object without exported symbols is like a breeding bull
<br>
without balls, if you whould excuse my language. I had to act and produce a
<br>
solution before libxml2-2.2.12 comes out, otherwise the new project file
<br>
which builds the DLL would be unusable to majority of those who would
<br>
eventually use it.
<br>
<p>The folowing patch appearantly solves the issue:
<br>
<p><p>E:\home\igor\src&gt;diff -c libxml2-2.2.11.orig\include\win32config.h
<br>
libxml2-2.2.11\include\win32config.h
<br>
*** libxml2-2.2.11.orig\include\win32config.h Fri Jan 05 2001 07:39:34 AM
<br>
--- libxml2-2.2.11\include\win32config.h Thu Jan 18 2001 06:53:27 PM
<br>
***************
<br>
*** 5,12 ****
<br>
--- 6,17 ----
<br>
<p>&nbsp;&nbsp;#include &lt;io.h&gt;
<br>
<p>+ #ifdef _USRDLL
<br>
+ #define LIBXML_DLL_IMPORT __declspec(dllexport)
<br>
+ #else
<br>
&nbsp;&nbsp;#define LIBXML_DLL_IMPORT
<br>
+ #endif
<br>
+
<br>
&nbsp;&nbsp;#define SOCKLEN_T int
<br>
<p>&nbsp;&nbsp;#ifdef INCLUDE_WINSOCK
<br>
<p><p>What do you think about it? If there is anyone out there who is familiar
<br>
with building libxml2 under Win32 (perhaps the person who introduced that
<br>
'LIBXML_DLL_IMPORT' in the code)? Is the patch above in place, or would it
<br>
break something? I have tested it here and it works fine, but I am just one
<br>
mortal with one computer...
<br>
<p>Ciao
<br>
Igor
<br>
<p><p><pre>
----
Message from the list <a href="mailto:xml@rpmfind.net?subject=Re:%20[xml]%20Win32%20shared%20object">xml@rpmfind.net</a>
Archived at : <a href="http://xmlsoft.org/messages/">http://xmlsoft.org/messages/</a>
to unsubscribe: echo &quot;unsubscribe xml&quot; | mail  <a href="mailto:majordomo@rpmfind.net?subject=Re:%20[xml]%20Win32%20shared%20object">majordomo@rpmfind.net</a>
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="1363.html">Daniel Veillard: "Re: [xml] xmlElemDumpMemory"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
<th><a href="author.html">Author view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2b29</a> 
: <em>Sun Jan 21 2001 - 18:43:27 EST</em>
</em>
</small>
</body>
</html>
